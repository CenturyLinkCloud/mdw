<bpm:processDefinition schemaVersion="5.5" xmlns:bpm="http://mdw.centurylink.com/bpm">
  <bpm:Process Id="MainProcess" name="JMS Adapter" version="0.1" description="">
    <bpm:Activity Id="A1" Name="Start" Implementation="com.centurylink.mdw.workflow.activity.process.ProcessStartActivity">
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=25,y=300,w=60,h=40"/>
    </bpm:Activity>
    <bpm:Activity Id="A2" Name="Stop" Implementation="com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity">
      <bpm:Attribute Name="DoNotNotifyCaller" Value="false"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=968,y=221,w=60,h=40"/>
    </bpm:Activity>
    <bpm:Activity Id="A3" Name="Synchronous Cloud&#13;&#10;JMS Request" Implementation="com.centurylink.mdw.workflow.adapter.jms.JmsAdapter">
      <bpm:Attribute Name="DO_LOGGING" Value="True"/>
      <bpm:Attribute Name="PostScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="PreScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="Queue Name" Value="com.centurylink.mdw.external.event.queue"/>
      <bpm:Attribute Name="REQUEST_VARIABLE" Value="request"/>
      <bpm:Attribute Name="RESPONSE_VARIABLE" Value="syncResponse"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=403,y=10,w=125,h=72"/>
      <bpm:Attribute Name="Wait for response?" Value="True"/>
    </bpm:Activity>
    <bpm:Activity Id="A4" Name="Synchronous?" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptEvaluator">
      <bpm:Attribute Name="Expression" Value="mode"/>
      <bpm:Attribute Name="SCRIPT" Value="Groovy"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=147,y=284,w=95,h=74"/>
    </bpm:Activity>
    <bpm:Activity Id="A6" Name="Platform?" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptEvaluator">
      <bpm:Attribute Name="Expression" Value="platform"/>
      <bpm:Attribute Name="SCRIPT" Value="Groovy"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=428,y=118,w=95,h=74"/>
    </bpm:Activity>
    <bpm:Activity Id="A7" Name="Synchronous OSGi&#13;&#10;JMS Request" Implementation="com.centurylink.mdw.workflow.adapter.jms.JmsAdapter">
      <bpm:Attribute Name="DO_LOGGING" Value="True"/>
      <bpm:Attribute Name="JNDI Server URL" Value="mdw-activemq"/>
      <bpm:Attribute Name="PostScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="PreScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="Queue Name" Value="com.centurylink.mdw.external.event.queue"/>
      <bpm:Attribute Name="REQUEST_VARIABLE" Value="request"/>
      <bpm:Attribute Name="RESPONSE_VARIABLE" Value="syncResponse"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=411,y=221,w=129,h=70"/>
      <bpm:Attribute Name="Wait for response?" Value="True"/>
    </bpm:Activity>
    <bpm:Activity Id="A8" Name="Asynchronous Cloud&#13;&#10;JMS Request" Implementation="com.centurylink.mdw.workflow.adapter.jms.JmsAdapter">
      <bpm:Attribute Name="DO_LOGGING" Value="True"/>
      <bpm:Attribute Name="PostScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="PreScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="Queue Name" Value="com.centurylink.mdw.external.event.queue"/>
      <bpm:Attribute Name="REQUEST_VARIABLE" Value="request"/>
      <bpm:Attribute Name="RESPONSE_VARIABLE" Value="syncResponse"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=413,y=385,w=125,h=72"/>
      <bpm:Attribute Name="Wait for response?" Value="False"/>
    </bpm:Activity>
    <bpm:Activity Id="A9" Name="Platform?" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptEvaluator">
      <bpm:Attribute Name="Expression" Value="platform"/>
      <bpm:Attribute Name="SCRIPT" Value="Groovy"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=433,y=500,w=95,h=74"/>
    </bpm:Activity>
    <bpm:Activity Id="A10" Name="Asynchronous OSGi&#13;&#10;JMS Request" Implementation="com.centurylink.mdw.workflow.adapter.jms.JmsAdapter">
      <bpm:Attribute Name="DO_LOGGING" Value="True"/>
      <bpm:Attribute Name="JNDI Server URL" Value="mdw-activemq"/>
      <bpm:Attribute Name="PostScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="PreScriptLang" Value="Groovy"/>
      <bpm:Attribute Name="Queue Name" Value="com.centurylink.mdw.external.event.queue"/>
      <bpm:Attribute Name="REQUEST_VARIABLE" Value="request"/>
      <bpm:Attribute Name="RESPONSE_VARIABLE" Value="syncResponse"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=411,y=602,w=129,h=70"/>
      <bpm:Attribute Name="Wait for response?" Value="False"/>
    </bpm:Activity>
    <bpm:Activity Id="A12" Name="Set Response&#13;&#10;JMS Message Id" Implementation="com.centurylink.mdw.workflow.activity.java.DynamicJavaActivity">
      <bpm:Attribute Name="DESCRIPTION" Value="For synchronous calls, grabs the jmsmessage Id from the &lt;RequestId> field in the MDWStatusMessage reponse, to help match with expected results"/>
      <bpm:Attribute Name="Java" Value="/**&#10; * Copyright (c) 2014 CenturyLink, Inc. All Rights Reserved.&#10; */&#13;&#10;&#13;&#10;package com.centurylink.mdw.tests;&#13;&#10;&#13;&#10;import java.util.Map;&#13;&#10;&#10;import com.centurylink.mdw.bpm.MDWStatusMessageDocument;&#10;import com.centurylink.mdw.java.JavaExecutionException;&#13;&#10;import com.centurylink.mdw.java.JavaExecutor;&#13;&#10;import com.centurylink.mdw.java.MdwJavaException;&#13;&#10;import com.centurylink.mdw.model.value.activity.ActivityRuntimeContext;&#13;&#10;&#13;&#10;/**&#13;&#10; * Dynamic Java executor.&#13;&#10; */&#13;&#10;public class SetResponseJMSMessageId_A12 implements JavaExecutor&#13;&#10;{&#13;&#10;  &#13;&#10;  public void initialize(ActivityRuntimeContext context) throws MdwJavaException&#13;&#10;  {&#13;&#10;    // TODO Auto-generated method stub&#13;&#10;  }&#13;&#10;&#13;&#10;  public Object execute(Map&lt;String,Object> variables) throws JavaExecutionException&#13;&#10;  {&#10;    System.out.println(variables.get(&quot;syncResponse&quot;));&#13;&#10;    MDWStatusMessageDocument doc = (MDWStatusMessageDocument)variables.get(&quot;syncResponse&quot;);&#10;    if (doc !=null) {&#10;      variables.put(&quot;jmsMessageId&quot;, doc.getMDWStatusMessage().getRequestID());&#10;    }&#10;    return null;&#10;  }&#13;&#10;&#13;&#10;}&#13;&#10;"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=769,y=58,w=100,h=73"/>
    </bpm:Activity>
    <bpm:Transition CompletionCode="" From="A1" To="A4" Event="FINISH" Id="T1">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=126,ly=309,type=Elbow,xs=89&amp;143,ys=320&amp;320"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="Cloud" From="A6" To="A3" Event="FINISH" Id="T6">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=475,ly=100,type=Elbow,xs=475&amp;475,ys=114&amp;86"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="Synchronous" From="A4" To="A6" Event="FINISH" Id="T7">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=365,ly=205,type=Elbow,xs=194&amp;424,ys=286&amp;155"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="OSGi" From="A6" To="A7" Event="FINISH" Id="T8">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=475,ly=193,type=Elbow,xs=475&amp;475,ys=196&amp;217"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="Cloud" From="A9" To="A8" Event="FINISH" Id="T11">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=480,ly=469,type=Elbow,xs=480&amp;480,ys=496&amp;461"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="OSGi" From="A9" To="A10" Event="FINISH" Id="T12">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=486,ly=591,type=Elbow,xs=480&amp;480,ys=578&amp;598"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="Asynchronous" From="A4" To="A9" Event="FINISH" Id="T13">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=314,ly=421,type=Elbow,xs=194&amp;429,ys=357&amp;537"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A8" To="A2" Event="FINISH" Id="T14">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=769,ly=349,type=Elbow,xs=542&amp;964,ys=421&amp;241"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A10" To="A2" Event="FINISH" Id="T15">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=775,ly=454,type=Elbow,xs=544&amp;964,ys=637&amp;241"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A3" To="A12" Event="FINISH" Id="T16">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=648,ly=70,type=Elbow,xs=532&amp;765,ys=70&amp;70"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A7" To="A12" Event="FINISH" Id="T17">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=654,ly=175,type=Elbow,xs=544&amp;765,ys=256&amp;94"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A12" To="A2" Event="FINISH" Id="T18">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=935,ly=155,type=Elbow,xs=873&amp;998,ys=94&amp;217"/>
    </bpm:Transition>
    <bpm:Attribute Name="PROCESS_VISIBILITY" Value="PUBLIC"/>
    <bpm:Attribute Name="NodeStyle" Value="BoxIcon"/>
    <bpm:Attribute Name="ArrowStyle" Value="ArrowEnd"/>
    <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=26,y=31,w=115,h=27"/>
    <bpm:Variables Name="asyncResponse" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="org.w3c.dom.Document"/>
    </bpm:Variables>
    <bpm:Variables Name="jmsMessageId" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="mode" ReferredAs="" Category="INPUT" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="platform" ReferredAs="" Category="INPUT" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="request" ReferredAs="" Category="INPUT" DisplaySequence="0">
      <bpm:type Name="com.centurylink.mdw.model.StringDocument"/>
    </bpm:Variables>
    <bpm:Variables Name="syncResponse" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="org.apache.xmlbeans.XmlObject"/>
    </bpm:Variables>
  </bpm:Process>
</bpm:processDefinition>