import groovy.json.JsonSlurper

// AdminApisWorkgroups
println 'Workgroups API CRUD...'

def vals = ['group-name': 'GroupA'];

def response = submit request('admin-apis.postman/GET:workgroups/{group-name}') {
  values = vals
}

assert response.time < 1000 // less than a second

if (response.status.code == 200) {
    // assert response.headers['content-type'] == 'application/json'
    def workgroup = new JsonSlurper().parseText(response.body)
    assert workgroup.name == 'GroupA'
    // delete the workgroup so we can submit a POST
    response = submit request('admin-apis.postman/DEL:workgroups/{group-name}') {
      values = vals
    }

    assert response.status.code == 200;
}

// create workgroup
response = submit request('admin-apis.postman/POST:workgroups') {
  values = vals
}

// case-insensitive header check
// assert response.checkHeader('content-type', 'application/json')

verify(response) {
  values = vals
}
