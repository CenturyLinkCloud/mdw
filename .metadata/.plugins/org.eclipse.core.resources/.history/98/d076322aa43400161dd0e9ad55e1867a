<bpm:processDefinition schemaVersion="5.5" xmlns:bpm="http://mdw.centurylink.com/bpm">
  <bpm:Process Id="MainProcess" name="SmartProcessParent" version="0.4" description="">
    <bpm:Activity Id="A1" Name="Start" Implementation="com.centurylink.mdw.workflow.activity.process.ProcessStartActivity">
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=19,y=111,w=60,h=40"/>
    </bpm:Activity>
    <bpm:Activity Id="A2" Name="Stop" Implementation="com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity">
      <bpm:Attribute Name="DoNotNotifyCaller" Value="false"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=729,y=281,w=60,h=40"/>
    </bpm:Activity>
    <bpm:Activity Id="A3" Name="Invoke Single" Implementation="com.centurylink.mdw.workflow.activity.process.InvokeSubProcessActivity">
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=309,y=25,w=100,h=60"/>
      <bpm:Attribute Name="processname" Value="com.centurylink.mdw.tests/SmartProcessChild"/>
      <bpm:Attribute Name="processversion" Value="[2.1,3)"/>
      <bpm:Attribute Name="synchronous" Value="TRUE"/>
      <bpm:Attribute Name="variables" Value="procName=#singleSubprocName;procVer=#singleSubprocVer"/>
    </bpm:Activity>
    <bpm:Activity Id="A4" Name="Invoke Multiple" Implementation="com.centurylink.mdw.workflow.activity.process.InvokeHeterogeneousProcessActivity">
      <bpm:Attribute Name="DELAY_BETWEEN" Value="1"/>
      <bpm:Attribute Name="Execution Plan" Value="executionPlan"/>
      <bpm:Attribute Name="Force Parallel Execution" Value="FALSE"/>
      <bpm:Attribute Name="STATUS_AFTER_EVENT" Value="Hold"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=317,y=302,w=107,h=64"/>
      <bpm:Attribute Name="processmap" Value="SmartProcessChild,com.centurylink.mdw.tests/SmartProcessChild,[2.1\,3),;SmartProcessChild2,SmartProcessChild2,[0.3\,1),"/>
      <bpm:Attribute Name="synchronous" Value="TRUE"/>
    </bpm:Activity>
    <bpm:Activity Id="A5" Name="Test&#13;&#10;Case?" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptEvaluator">
      <bpm:Attribute Name="Expression" Value="#{testCase}"/>
      <bpm:Attribute Name="SCRIPT" Value="javax.el"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=144,y=108,w=89,h=46"/>
    </bpm:Activity>
    <bpm:Activity Id="A7" Name="Invoke Single&#13;&#10;Old" Implementation="com.centurylink.mdw.workflow.activity.process.InvokeSubProcessActivity">
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=503,y=93,w=100,h=60"/>
      <bpm:Attribute Name="processname" Value="SmartProcessChild"/>
      <bpm:Attribute Name="processversion" Value="1.1"/>
      <bpm:Attribute Name="synchronous" Value="TRUE"/>
      <bpm:Attribute Name="variables" Value="procName=$singleSubprocNameOld;procVer=$singleSubprocVerOld"/>
    </bpm:Activity>
    <bpm:Activity Id="A8" Name="Create Plan" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptExecutorActivity">
      <bpm:Attribute Name="Output Documents" Value="executionPlan"/>
      <bpm:Attribute Name="Rule" Value="import com.centurylink.mdw.bpm.ProcessExecutionPlanDocument&#13;&#10;import com.centurylink.mdw.bpm.ParameterDocument.Parameter&#13;&#10;import com.centurylink.mdw.bpm.ProcessExecutionPlanDocument.ProcessExecutionPlan&#13;&#10;import com.centurylink.mdw.bpm.SubprocessInstanceDocument.SubprocessInstance&#13;&#10;import com.centurylink.mdw.model.data.work.WorkStatus&#13;&#10;&#13;&#10;executionPlan = ProcessExecutionPlanDocument.Factory.newInstance();&#13;&#10;ProcessExecutionPlan exeplan = executionPlan.addNewProcessExecutionPlan();&#13;&#10;SubprocessInstance subprocinst = exeplan.addNewSubprocessInstance();&#13;&#10;subprocinst.setLogicalProcessName(&quot;SmartProcessChild&quot;);&#13;&#10;subprocinst.setStatusCode(WorkStatus.STATUS_PENDING_PROCESS.intValue());&#13;&#10;addParameter(subprocinst, &quot;inputVar&quot;, &quot;child11&quot;);&#13;&#10;addParameter(subprocinst, &quot;procName&quot;, &quot;\$&quot;);&#13;&#10;addParameter(subprocinst, &quot;procVer&quot;, &quot;\$&quot;);&#13;&#10;subprocinst = exeplan.addNewSubprocessInstance();&#13;&#10;subprocinst.setLogicalProcessName(&quot;SmartProcessChild&quot;);&#13;&#10;subprocinst.setStatusCode(WorkStatus.STATUS_PENDING_PROCESS.intValue());&#13;&#10;addParameter(subprocinst, &quot;inputVar&quot;, &quot;child12&quot;);&#13;&#10;subprocinst = exeplan.addNewSubprocessInstance();&#13;&#10;subprocinst.setLogicalProcessName(&quot;SmartProcessChild2&quot;);&#13;&#10;subprocinst.setStatusCode(WorkStatus.STATUS_PENDING_PROCESS.intValue());&#13;&#10;addParameter(subprocinst, &quot;inputVar&quot;, &quot;\$subprocInputVar&quot;);&#13;&#10;addParameter(subprocinst, &quot;procName&quot;, &quot;\$&quot;);&#13;&#10;addParameter(subprocinst, &quot;procVer&quot;, &quot;\$&quot;);&#13;&#10;&#13;&#10;void addParameter(SubprocessInstance subprocinst, String name, String value) {&#13;&#10; Parameter param = subprocinst.addNewParameter();&#13;&#10; param.setName(name);&#13;&#10; param.setStringValue(value);&#13;&#10;}&#13;&#10;"/>
      <bpm:Attribute Name="SCRIPT" Value="Groovy"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=321,y=180,w=100,h=60"/>
    </bpm:Activity>
    <bpm:Activity Id="A9" Name="Assign Output" Implementation="com.centurylink.mdw.workflow.activity.script.ScriptExecutorActivity">
      <bpm:Attribute Name="Rule" Value="import com.centurylink.mdw.bpm.ParameterDocument.Parameter&#13;&#10;import com.centurylink.mdw.bpm.SubprocessInstanceDocument.SubprocessInstance&#13;&#10;&#13;&#10;SubprocessInstance subprocinst = executionPlan.getProcessExecutionPlan().getSubprocessInstanceList().get(0);&#13;&#10;multipleSubprocName = getParameter(subprocinst, &quot;procName&quot;);&#13;&#10;multipleSubprocVer = getParameter(subprocinst, &quot;procVer&quot;);&#13;&#10;subprocinst = executionPlan.getProcessExecutionPlan().getSubprocessInstanceList().get(2);&#13;&#10;multipleSubprocName2 = getParameter(subprocinst, &quot;procName&quot;);&#13;&#10;multipleSubprocVer2 = getParameter(subprocinst, &quot;procVer&quot;);&#13;&#10;&#13;&#10;protected String getParameter(SubprocessInstance subprocinst, String name) {&#13;&#10; if (subprocinst.getParameterList()==null) return null;&#13;&#10; for (Parameter p : subprocinst.getParameterList()) {&#13;&#10;  if (p.getName().equals(name)) return p.getStringValue();&#13;&#10; }&#13;&#10; return null;&#13;&#10;}"/>
      <bpm:Attribute Name="SCRIPT" Value="Groovy"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=498,y=307,w=100,h=60"/>
    </bpm:Activity>
    <bpm:Activity Id="A10" Name="Compatibility" Implementation="com.centurylink.mdw.workflow.activity.process.InvokeSubProcessActivity">
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=139,y=217,w=100,h=60"/>
      <bpm:Attribute Name="processname" Value="SmartProcessChildCompat"/>
      <bpm:Attribute Name="processversion" Value="10002"/>
      <bpm:Attribute Name="synchronous" Value="TRUE"/>
    </bpm:Activity>
    <bpm:Activity Id="A11" Name="Stop" Implementation="com.centurylink.mdw.workflow.activity.process.ProcessFinishActivity">
      <bpm:Attribute Name="DoNotNotifyCaller" Value="false"/>
      <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=160,y=335,w=60,h=40"/>
    </bpm:Activity>
    <bpm:Transition CompletionCode="" From="A1" To="A5" Event="FINISH" Id="T1">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=128,ly=76,type=Elbow,xs=83&amp;140,ys=131&amp;131"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A3" To="A7" Event="FINISH" Id="T2">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=478,ly=153,type=Elbow,xs=413&amp;499,ys=55&amp;123"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="single" From="A5" To="A3" Event="FINISH" Id="T3">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=231,ly=100,type=Elbow,xs=237&amp;305,ys=131&amp;55"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="multiple" From="A5" To="A8" Event="FINISH" Id="T4">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=268,ly=175,type=Elbow,xs=233&amp;260&amp;260&amp;317,ys=143&amp;143&amp;214&amp;214"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A4" To="A9" Event="FINISH" Id="T5">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=504,ly=359,type=Elbow,xs=428&amp;494,ys=336&amp;336"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A7" To="A2" Event="FINISH" Id="T6">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=674,ly=175,type=Elbow,xs=607&amp;759,ys=123&amp;277"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A8" To="A4" Event="FINISH" Id="T7">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=371,ly=260,type=Elbow,xs=371&amp;371,ys=244&amp;298"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A9" To="A2" Event="FINISH" Id="T8">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=672,ly=314,type=Elbow,xs=602&amp;725,ys=314&amp;314"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="oldStyle" From="A5" To="A10" Event="FINISH" Id="T9">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=134,ly=179,type=Elbow,xs=188&amp;188,ys=158&amp;213"/>
    </bpm:Transition>
    <bpm:Transition CompletionCode="" From="A10" To="A11" Event="FINISH" Id="T10">
      <bpm:Attribute Name="TRANSITION_DISPLAY_INFO" Value="lx=190,ly=305,type=Elbow,xs=190&amp;190,ys=281&amp;331"/>
    </bpm:Transition>
    <bpm:Attribute Name="PROCESS_VISIBILITY" Value="PUBLIC"/>
    <bpm:Attribute Name="NodeStyle" Value="BoxIcon"/>
    <bpm:Attribute Name="ArrowStyle" Value="ArrowEnd"/>
    <bpm:Attribute Name="WORK_DISPLAY_INFO" Value="x=26,y=26,w=184,h=27"/>
    <bpm:Variables Name="executionPlan" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="org.apache.xmlbeans.XmlObject"/>
    </bpm:Variables>
    <bpm:Variables Name="multipleSubprocName" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="multipleSubprocName2" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="multipleSubprocVer" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="multipleSubprocVer2" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="singleSubprocName" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="singleSubprocNameOld" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="singleSubprocVer" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="singleSubprocVerOld" ReferredAs="" Category="LOCAL" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="subprocInputVar" ReferredAs="" Category="INPUT" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
    <bpm:Variables Name="testCase" ReferredAs="" Category="INPUT" DisplaySequence="0">
      <bpm:type Name="java.lang.String"/>
    </bpm:Variables>
  </bpm:Process>
</bpm:processDefinition>