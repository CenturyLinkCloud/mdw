<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:mdw="http://www.centurylink.com/mdw/jsf"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:t="http://myfaces.apache.org/tomahawk">

  <ui:composition>

    <div style="max-height:500px;overflow:auto;padding:0;">
      <a4j:form id="taskListForm" ajaxSubmit="true" reRender="adminDetailPanel" styleClass="mdw_form">
        <mdw:list
          id="taskList"
          listId="tasks"
          listEntity="#{listManager.taskTemplateList}"
          label="Tasks" />
      </a4j:form>
    </div>
    
    <!-- task import panel -->
    <rich:modalPanel
      id="taskImportModalPanel"
      width="500"
      height="150">
      <f:facet name="header">
        <h:panelGroup>
          <div style="height:14px;">
            <h:graphicImage value="/images/import.png" />
            <h:outputText value="Import Task Templates" style="position:relative;top:-3px;left:2px;" />
          </div>
        </h:panelGroup>
      </f:facet>
      <f:facet name="controls">
        <h:panelGroup>
          <h:graphicImage
            id="hideImportLink"
            value="/images/close.png"
            styleClass="hidelink" />
          <rich:componentControl 
            for="taskImportModalPanel" 
            attachTo="hideImportLink" 
            operation="hide" 
            event="onclick"/>
        </h:panelGroup>
      </f:facet>
      <h:form 
        id="taskImportForm"
        enctype="multipart/form-data">
        <h:outputText value="Select file to import:" styleClass="mdw_fileUpload"/>
        <div style="position:relative;">      
          <t:inputFileUpload
            id="fileupload"
            immediate="true"
            accept="*"
            value="#{taskTemplateListController.importFile}"
            storage="file"
            style="width:440px;height:20px;position:relative;filter:alpha(opacity:0);opacity:0;z-index:2;#{webUtil.firefox?'text-align:right':''};"
            required="false"
            maxlength="#{webUtil.maxUploadFileSize}"
            onchange="this.form.fileUploadInput.value=this.value;"
            onkeypress="return false;">
            <f:validator validatorId="attachmentValidator"/>
          </t:inputFileUpload>
          <t:div style="position:absolute;top:#{webUtil.firefox?'-2px':'0px'};left:0px;z-index:1;">
            <input id="fileUploadInput" type="text" autocomplete="off" class="mdw_fileUpload" style="width:350px;background-color:#e4e4e4;background-image:none;" onkeypress="return false;" />
            <input id="fileUploadBrowse"  type="submit" value="Browse..." onclick="return false;" />
          </t:div>
        </div>
    
        <h:commandButton
          value="Import"
          styleClass="mdw_detailFormButtons"
          style="margin-top:10px;"
          action="#{taskTemplateListController.doImport}" />
      
        <h:commandButton
          id="taskImportCancelButton"
          value="Cancel"
          onclick="return false;"
          style="width:60px;margin-right:2px;margin-left:5px;" />
        <rich:componentControl
          for="taskImportModalPanel" 
          attachTo="taskImportCancelButton"
          operation="hide"
          event="onclick" />
      </h:form>      
    </rich:modalPanel>
    
    <!-- task export panel -->
    <rich:modalPanel
      id="taskExportModalPanel"
      width="250"
      height="100">
      <f:facet name="header">
        <h:panelGroup>
          <div style="height:14px;">
            <h:graphicImage value="/images/export.png" />
            <h:outputText value="Export Task Templates" style="position:relative;top:-3px;left:2px;" />
          </div>
        </h:panelGroup>
      </f:facet>
      <f:facet name="controls">
        <h:panelGroup>
          <h:graphicImage
            id="hideExportLink"
            value="/images/close.png"
            styleClass="hidelink" />
          <rich:componentControl 
            for="taskExportModalPanel" 
            attachTo="hideExportLink" 
            operation="hide" 
            event="onclick"/>
        </h:panelGroup>
      </f:facet>
      <h:outputText value="Export selected Task Templates to a file?" />
      <br/>
      <h:commandButton
        value="Export"
        styleClass="mdw_detailFormButtons"
        style="margin-top:10px;"
        onclick="#{rich:component('taskExportModalPanel')}.hide();document.getElementById('adminDetailPanelGroup').innerHTML='';window.location.href='?exportTaskTemplates=true';return false;" />
      <h:commandButton
        id="taskExportCancelButton"
        value="Cancel"
        onclick="return false;"
        style="width:60px;margin-right:2px;margin-left:5px;" />
      <rich:componentControl
        for="taskExportModalPanel" 
        attachTo="taskExportCancelButton"
        operation="hide"
        event="onclick" />
    </rich:modalPanel>
    
    <rich:componentControl
      for="taskImportModalPanel"
      attachTo="importTaskTemplates"
      operation="show"
      event="onclick"/>    

    <rich:componentControl
      for="taskExportModalPanel"
      attachTo="exportTaskTemplates"
      operation="show"
      event="onclick"/>
      
  </ui:composition>

</html>