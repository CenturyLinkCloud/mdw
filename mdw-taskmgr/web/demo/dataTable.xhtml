<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:mdw="http://www.centurylink.com/mdw/jsf">
  <ui:composition template="/facelets/layout/layout.xhtml">
    <ui:define name="content">
      <rich:panel header="Data Table" styleClass="mdw_defaultPanel" style="width:700px">
        <h:form>
          <rich:dataTable id="tasksDataTable"
            onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
            onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
            cellpadding="0" cellspacing="0" width="680" border="0"
            var="task"
            rowKeyVar="row"
            ajaxKeys="#{listManager.taskList.keys}"
            value="#{listManager.taskList.items}">
    
            <rich:column id="name">
              <f:facet name="header">
                <h:outputText value="Task Name" />
              </f:facet>
              <h:outputText value="#{task.name}" />
            </rich:column>
            <rich:column id="id">
              <f:facet name="header">
                <h:outputText value="Definition ID" />
              </f:facet>
              <h:outputText value="#{task.id}" />
            </rich:column>
            <rich:column id="description">
              <f:facet name="header">
                <h:outputText value="Description" />
              </f:facet>
              <h:outputText value="#{task.comment}" />
            </rich:column>
            <rich:column id="type">
              <f:facet name="header">
                <h:outputText value="Type" />
              </f:facet>
              <h:outputText value="#{task.taskType}" />
            </rich:column>
            <rich:column id="actions">
              <f:facet name="header">
                <h:outputText value="Actions" />
              </f:facet>
              <a4j:commandLink id="editlink"
                ajaxSingle="true" 
                oncomplete="#{rich:component('editPanel')}.show()">
                <h:graphicImage value="/images/edit.gif" style="border:0" />
                <f:setPropertyActionListener value="#{task}"
                  target="#{listManager.taskList.currentItem}" />
              </a4j:commandLink>
              <rich:toolTip for="editlink" value="Edit" />
              <a4j:commandLink id="deletelink"
                ajaxSingle="true" 
                oncomplete="#{rich:component('deletePanel')}.show()">
                <h:graphicImage value="/images/delete.gif" style="border:0" />
                <f:setPropertyActionListener value="#{task}"
                  target="#{listManager.taskList.currentItem}" />
              </a4j:commandLink>
              <rich:toolTip for="deletelink" value="Delete" />
            </rich:column>
          </rich:dataTable>
        </h:form>
        
        <rich:modalPanel id="editPanel" autosized="true" width="450">
          <f:facet name="header">
            <h:outputText value="Edit Task ID #{listManager.taskList.currentItem.id}" />
          </f:facet>
          <f:facet name="controls">
            <h:panelGroup>
              <h:graphicImage id="epHidelink" value="/images/close.png" styleClass="hidelink" />
              <rich:componentControl
                for="taskEditPanel"
                attachTo="epHidelink"
                operation="hide"
                event="onclick" />
            </h:panelGroup>
          </f:facet>
          <h:form>
            <rich:messages style="color:red;"></rich:messages>
            <h:panelGrid columns="1">
              <a4j:outputPanel ajaxRendered="true">
                <h:panelGrid columns="2">
                  <mdw:label value="Name" required="true" />
                  <h:inputText value="#{listManager.taskList.currentItem.name}" size="60" required="true"
                    styleClass="mdw_inputValue" />
                  <mdw:label value="Description" />
                  <h:inputTextarea value="#{listManager.taskList.currentItem.comment}" rows="4"
                    styleClass="mdw_inputField mdw_textAreaInput"
                    style="white-space:pre-wrap;" />
                </h:panelGrid>
              </a4j:outputPanel>
              <h:panelGrid columns="2">
                <a4j:commandButton value="Save"
                  action="#{listManager.taskList.saveCurrentItem}"
                  reRender="name, description"
                  oncomplete="#{rich:component('editPanel')}.hide();"
                  style="width:50px;" />
                <t:commandButton id="editCancelButton" value="Cancel"
                  onclick="return false;"
                  style="width:60px;" />
                <rich:componentControl
                  for="editPanel" 
                  attachTo="editCancelButton"
                  operation="hide"
                  event="onclick" />
              </h:panelGrid>              
            </h:panelGrid>
          </h:form>
        </rich:modalPanel>
        <rich:modalPanel id="deletePanel" autosized="true" width="300">
          <f:facet name="header">
            <h:outputText value="Delete Task" />
          </f:facet>
          <f:facet name="controls">
            <h:panelGroup>
              <h:graphicImage id="dpHidelink" value="/images/close.png" styleClass="hidelink" />
              <rich:componentControl
                for="deletePanel"
                attachTo="dpHidelink"
                operation="hide"
                event="onclick" />
            </h:panelGroup>
          </f:facet>
          <h:form>
            <a4j:outputPanel ajaxRendered="true">
              <h:outputText value="Delete Task '#{listManager.taskList.currentItem.name}'?" />
            </a4j:outputPanel>
            <h:panelGrid columns="2" style="margin-top:10px;">
              <a4j:commandButton
                value="Delete"
                ajaxSingle="true"
                action="#{listManager.taskList.deleteCurrentItem}"
                oncomplete="#{rich:component('deletePanel')}.hide();"
                reRender="tasksDataTable"
                style="width:50px;" />            
              <t:commandButton
                id="taskDeleteCancelButton"
                value="Cancel"
                onclick="return false;"
                style="width:60px;" />
              <rich:componentControl
                for="deletePanel" 
                attachTo="taskDeleteCancelButton"
                operation="hide"
                event="onclick" />
            </h:panelGrid>
          </h:form>
        </rich:modalPanel>
      </rich:panel>
    </ui:define>
  </ui:composition>
</html>