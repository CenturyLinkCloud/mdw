# Where JBoss EWS Tomcat installation lives
TOMADM_HOME="/foss/foss-ews/"
CLEARTRUST="/foss/appl/CT"
CATALINA_HOME="/foss/appl/jboss-ews/jboss-ews-2.1/tomcat7"
CATALINA_BASE="/foss/foss-ews/instances/mdwews-dev1/current"
JASPER_HOME="${CATALINA_HOME}"
CATALINA_TMPDIR="${CATALINA_BASE}/temp"
JAVA_ENDORSED_DIRS="${CATALINA_HOME}/endorsed"


# Where your java installation lives

APP_NAME="-Dmdwews-dev1"

#Set JAVA Environment
if rpm -qa | grep -q "6Server"; then
     JAVA_HOME="/usr/lib/jvm/java-1.7.0"
     JRE_HOME="/usr/lib/jvm/java-1.7.0/jre"
     JAVADIR="/usr/lib/jvm/java-1.7.0/bin"
     jvmRoute=`uname -n | awk -F "." '{print $1}'`
     JMX_PORT=12084
else
     JAVA_HOME="/usr/lib/jvm/java-1.7.0"
     JRE_HOME="/usr/lib/jvm/java-1.7.0/jre"
     JAVADIR="/usr/lib/jvm/java-1.7.0/bin"
     jvmRoute=`uname -n | awk -F "." '{print $1}'`
     JMX_PORT=12084
fi

# Pass Parameters to JAVA using format:
# (JAVA_OPTS="${JAVA_OPTS} <parameters>"
# NOTE: Do not put all on one line with the exception of JVM Heap Sizes.
# This Section Developers need to include in FOSS RDD.

#JAVA_OPTS="${JAVA_OPTS} -Xminf0.1 -Xmaxf0.3"
#JAVA_OPTS="${JAVA_OPTS} -Djava.awt.headless=true"
JAVA_OPTS="${JAVA_OPTS} -server -Xms256m -Xmx1536m -XX:MaxPermSize=128m -XX:+UseParallelGC -XX:+UseParallelOldGC"
#JAVA_OPTS="${JAVA_OPTS} -server -Xms256m -Xmx256m -XX:+UseParallelGC -XX:+UseParallelOldGC"
JAVA_OPTS="${JAVA_OPTS} -XX:ErrorFile=${CATALINA_BASE}/logs/hs_err_pid%p.log"
JAVA_OPTS="${JAVA_OPTS} -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=${CATALINA_BASE}/logs"
JAVA_OPTS="${JAVA_OPTS} -verbose:gc -Xloggc:${CATALINA_BASE}/logs/gclogs.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps"
JAVA_OPTS="${JAVA_OPTS} -XX:+UnlockCommercialFeatures -XX:+FlightRecorder"
#JAVA_OPTS="${JAVA_OPTS} -Xdebug -Xrunjdwp:transport=dt_socket,server=n,suspend=y,address=9500"

# Pass Parameters for CATALINA_OPTS using format:
#CATALINA_OPTS="${CATALINA_OPTS} -D<parameters>"
# NOTE: Do not put all on one line
# This Section Developers need to include in FOSS RDD.

#CATALINA_OPTS="$CATALINA_OPTS -Djava.security.debug=all"
#CATALINA_OPTS="$CATALINA_OPTS -Djava.security.debug=access,failure"
CATALINA_OPTS="$CATALINA_OPTS -Dcom.qwest.appsec.CTAPPFilterConfigFilePath=CenturyLink/config/CTAPPFilter.config"
CATALINA_OPTS="$CATALINA_OPTS -Dcom.qwest.appsec.CTECOMFilterConfigFilePath=conf/CTECOMFilter.config"
CATALINA_OPTS="${CATALINA_OPTS} -Djava.security.auth.login.config==${CATALINA_BASE}/conf/jaas.config"
CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.trustStore=/foss/foss-ews/certs/foss.truststore"
CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.trustStorePassword=changeit"
CATALINA_OPTS="${CATALINA_OPTS} -Denv=dev"
#CATALINA_OPTS="${CATALINA_OPTS} -DruntimeEnv=dev"
CATALINA_OPTS="${CATALINA_OPTS} -DruntimeEnv=cloudDev"
CFG_DIR=$CATALINA_BASE/CenturyLink/config
CATALINA_OPTS="${CATALINA_OPTS} -Dmdw.config.location=$CFG_DIR"
CATALINA_OPTS="${CATALINA_OPTS} -Dmdw.logger.impl=org.apache.log4j.Logger"
CATALINA_OPTS="${CATALINA_OPTS} -Dlog4j.configuration=file://$CFG_DIR/log4j.properties"
CATALINA_OPTS="${CATALINA_OPTS} -Djava.util.logging.config.file=$CFG_DIR/logging.properties"
#CATALINA_OPTS="${CATALINA_OPTS} -Dmdw.hub.dev.web.root=c:\workspaces\mdw55\mdw-hub\web"

# JMX Configuration COMMON for all
CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote"
CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.port=12084"

# JMX Configuration with NO Authentication, NO SSL
# NOTE: Default for MDT, TEST & PROD Environments.
# PROD will require a  change, but for initial inventory of JON this should be the default.
CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.ssl=false"
CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.authenticate=false"

# JMX Configuration with Password Authentication, NO SSL
# NOTE: Using jmxremote.access & jmxremote.password in conf directory
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.ssl=false"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.authenticate=true"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.access.file=${CATALINA_BASE}/conf/jmxremote.access"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.password.file=${CATALINA_BASE}/conf/jmxremote.password"

# JMX Configuration with Password Authentication and SSL
# NOTE: Using jmxremote.access & jmxremote.password in conf directory
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.ssl=true"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.authenticate=true"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.access.file=${CATALINA_BASE}/conf/jmxremote.access"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.password.file=${CATALINA_BASE}/conf/jmxremote.password"
#CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.keyStore=/foss/foss-ews/certs/jmxServer.keystore"
#CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.keyStorePassword=fossjmx"

# JMX Configuration with ClearTrust JAAS Realm Authentication and SSL
# NOTE:  Uses jmxremote.access with respective LDAP Group entry.
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.ssl=true"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.authenticate=true"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.login.config=cleartrust_login"
#CATALINA_OPTS="${CATALINA_OPTS} -Dcom.sun.management.jmxremote.access.file=${CATALINA_BASE}/conf/jmxremote.access"
#CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.keyStore=/foss/foss-ews/certs/jmxServer.keystore"
#CATALINA_OPTS="${CATALINA_OPTS} -Djavax.net.ssl.keyStorePassword=fossjmx"

# Setup local server jars in CLASSPATH


#CLASSPATH=""
CLASSPATH=/opt/tib/MIDD50/tibrv/lib/tibrvj.jar;
PATH=$PATH:/opt/tib/MIDD50/tibrv/bin;
for i in ${CLEARTRUST}/ct_realm/lib/*
do
   CLASSPATH=${CLASSPATH}:${i}
done

export CLASSPATH

export CATALINA_HOME CATALINA_BASE JASPER_HOME CATALINA_TMPDIR JAVA_ENDORSED_DIRS
# What user should run tomcat
#TOMCAT_USER="mdwews-dev1"
TOMCAT_USER="mdwweblk"

# You can change your tomcat locale here
#LANG=en_US

# Time to wait in seconds, before killing process
SHUTDOWN_WAIT=30

# Set the TOMCAT_PID location
CATALINA_PID=${CATALINA_BASE}/logs/mdwews-dev1.pid

# If you wish to further customize your tomcat environment,
# put your own definitions here
# (i.e. LD_LIBRARY_PATH for some jdbc drivers)
# Just do not forget to export them :)
# This Section Developers need to include in FOSS RDD.
LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CATALINA_HOME/lib
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/tib/MIDD50/tibrv/lib